@inject HttpClient Http
@rendermode InteractiveWebAssembly

@if (!profileSetupCompleted)
{
    <MudAlert
        Class="sticky-alert"
        Variant="Variant.Filled"
        Severity="Severity.Warning"
        ShowCloseIcon>
        Please complete your profile setup.
        <MudLink Href="/profile-setup" Color="Color.Inherit" Style="text-decoration: underline; font-size: 14px;">
            Complete setup
        </MudLink>
    </MudAlert>
}


@code {
    private bool profileSetupCompleted = false;
    
    protected override async Task OnInitializedAsync()
    {
        try
        {
            var result = await Http.GetFromJsonAsync<ProfileStatus>("api/users/profile-status");
            profileSetupCompleted = result?.ProfileSetupCompleted ?? false;
            
        }
        catch
        {
            profileSetupCompleted = false;
        }
    }
    
    private class ProfileStatus
    {
        public bool ProfileSetupCompleted { get; set; }
    }

}
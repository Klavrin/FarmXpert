@page "/subsidies"
@* @rendermode InteractiveWebAssembly *@
@inject IJSRuntime Js

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-6">
    <MudText Typo="Typo.h4" GutterBottom="true">Recommended Subsidies</MudText>

    @foreach (var subsidy in RecommendedSubsidies)
    {
        <MudPaper Class="p-4 mb-4 rounded-lg text-dark" style="@($"background-color:{(IsDarkMode ? subsidy.ColorDarkMode : subsidy.Color)};")">
            <MudStack Row="true" Spacing="2">
                @if (subsidy.HasStar)
                {
                    <MudIcon Icon="@Icons.Material.Filled.Star" Color="Color.Warning" />
                }
                <MudText @onclick="Hello" Typo="Typo.h6" Class="font-semibold">@subsidy.Title</MudText>
            </MudStack>

            <MudText Class="mt-2" Typo="Typo.body2">@subsidy.Description</MudText>

            <MudStack Justify="Justify.FlexEnd">
                <MudButton Variant="Variant.Filled" Color="Color.Success" Class="mt-4">
                    Download Document
                </MudButton>
            </MudStack>
        </MudPaper>
    }

    <MudText Typo="Typo.h5" Class="mt-6 mb-2">Other Subsidies</MudText>

    @foreach (var subsidy in OtherSubsidies)
    {
        <MudPaper Class="p-4 mb-4 rounded-lg text-dark" style="@($"background-color:{(IsDarkMode ? subsidy.ColorDarkMode : subsidy.Color)};")">
            <MudText Typo="Typo.h6" Class="font-semibold">@subsidy.Title</MudText>
            <MudText Class="mt-2" Typo="Typo.body2">@subsidy.Description</MudText>
            
            <MudStack Justify="Justify.FlexEnd">
                <MudButton Variant="Variant.Filled" Color="Color.Success" Class="mt-4"
                           OnClick="@(() => OnDownload(subsidy.Title))">
                    Download Document
                </MudButton>
            </MudStack>
        </MudPaper>
    }
</MudContainer>

@code {
    [CascadingParameter]
    public bool IsDarkMode { get; set; }

    private void Hello()
    {
        Console.WriteLine(IsDarkMode);
    }
    
    class Subsidy
    {
        public string Title { get; set; } = "";
        public string Description { get; set; } = "";
        public string Color { get; set; } = "#ffffff";
        public string ColorDarkMode { get; set; } = String.Empty;
        public bool HasStar { get; set; } = false;
    }
    
    private async Task OnDownload(string title)
    {
        var pdfBase64 = "JVBERi0xLjQKJeLjz9MKNCAwIG9iago8PC9UeXBlIC9QYWdlL1BhcmVudCAxIDAgUi9SZXNvdXJjZXMgMiAwIFIvQ29udGVudHMgNSAwIFIvTWVkaWFCb3hbMCAwIDYxMiA3OTJdPj4KZW5kb2JqCjUgMCBvYmoKPDwvTGVuZ3RoIDY2Pj4Kc3RyZWFtCkJUIC9GMCAxMiBUZgowIDUwIFRkCihIZWxsbyBmcm9tIEJsYXpvciBERVBDUCkgVGoKRVQKZW5kc3RyZWFtCmVuZG9iagp4cmVmCjAgNgowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAxMDUgMDAwMDAgbiAKMDAwMDAwMDE1MCAwMDAwMCBuIAowMDAwMDAwMjAwIDAwMDAwIG4gCjAwMDAwMDAzMDIgMDAwMDAgbiAKMDAwMDAwMDQyMCAwMDAwMCBuIAp0cmFpbGVyCjw8L1Jvb3QgMSAwIFIvU2l6ZSA2Pj4Kc3RhcnR4cmVmCjU0NQolJUVPRgo=";

        await Js.InvokeVoidAsync("downloadFileAnotherFile",
            "Investiții în bazine de acumulare a apei pentru irigare.pdf",
            "application/pdf",
            pdfBase64
        );
    }


    private List<Subsidy> RecommendedSubsidies = new()
    {
        new Subsidy {
            Title = "Investiții în bazine de acumulare a apei pentru irigare",
            Description = "Scor estimat pe bază de potrivire textuală între descrierea subvenției și profilul fermei. Semnale detectate: animal, bazine, bovine, carne, cerealiere, culturi, cultură, infrastructură, irigare, lapte, legume, ovine, porcine, sector vegetal, tehnologii, zootehnic, zootehnie. Suprafață: 31.5 ha; efective: 120 capete.",
            Color = "#e8f5e9",
            // Color = "#388e3c",
            ColorDarkMode = "#1f3d2b",
            HasStar = true
        },
        new Subsidy {
            Title = "Investiții în exploatații din sectorul vegetal",
            Description = "Scor estimat pe bază de potrivire textuală între descrierea subvenției și profilul fermei. Semnale detectate: animal, bazine, bovine, carne, cerealiere, culturi, cultură, infrastructură, irigare, lapte, legume, ovine, porcine, sector vegetal, tehnologii, zootehnic, zootehnie. Suprafață: 31.5 ha; efective: 120 capete.",
            Color = "#fff3e0",
            // Color = "#fff3e0",
            ColorDarkMode = "#3a2a14",
        },
        new Subsidy {
            Title = "Investiții în infrastructura din sectorul vegetal",
            Description = "Scor estimat pe bază de potrivire textuală între descrierea subvenției și profilul fermei. Semnale detectate: animal, bazine, bovine, carne, cerealiere, culturi, cultură, infrastructură, irigare, lapte, legume, ovine, porcine, sector vegetal, tehnologii, zootehnic, zootehnie. Suprafață: 31.5 ha; efective: 120 capete.",
            Color = "#fff3e0",
            ColorDarkMode = "#3b3a1a",
        }
    };

    private List<Subsidy> OtherSubsidies = new()
    {
        new Subsidy {
            Title = "Investiții în tehnologii de lucrare a solului",
            Description = "Scor estimat pe bază de potrivire textuală între descrierea subvenției și profilul fermei. Semnale detectate: animal, bazine, bovine, carne, cerealiere, culturi, cultură, infrastructură, irigare, lapte, legume, ovine, porcine, sector vegetal, tehnologii, zootehnic, zootehnie. Suprafață: 31.5 ha; efective: 120 capete.",
            Color = "#ffebee",
            // Color = "#d3302f",
            ColorDarkMode = "#3a1d22"
        }
    };
}
